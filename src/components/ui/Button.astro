---
import { buttonVariants, type ButtonVariant, type ButtonSize } from "./button";

interface Props {
  href?: string;
  variant?: ButtonVariant;
  size?: ButtonSize;
  class?: string;
  type?: "button" | "submit" | "reset";
  disabled?: boolean;
  target?: string;
  rel?: string;
  [key: string]: any;
}

const {
  href,
  variant = "default",
  size = "default",
  class: className,
  type = "button",
  disabled = false,
  target,
  rel,
  ...restProps
} = Astro.props;

const computedClasses = buttonVariants({ variant, size, className });

// Build link props if href is provided
let linkProps: Record<string, any> | null = null;
if (href) {
  const linkClasses = [computedClasses, "border-b-0"];
  
  if (disabled) {
    linkClasses.push("pointer-events-none");
  }
  
  linkProps = {
    ...restProps,
    href,
    class: linkClasses.join(" "),
  };
  
  if (disabled) {
    linkProps["aria-disabled"] = "true";
    linkProps.tabindex = "-1";
  }
  
  if (target === "_blank" && !rel) {
    linkProps.rel = "noopener noreferrer";
  } else if (target) {
    linkProps.target = target;
  }
  
  if (rel) {
    linkProps.rel = rel;
  }
}
---

{linkProps ? (
  <a {...linkProps}>
    <slot />
  </a>
) : (
  <button
    class={computedClasses}
    type={type}
    disabled={disabled}
    {...restProps}
  >
    <slot />
  </button>
)}

